
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../reference_romscom/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>rcutils - ROMS Communication Toolbox (romscom)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#romscom.rcutils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ROMS Communication Toolbox (romscom)" class="md-header__button md-logo" aria-label="ROMS Communication Toolbox (romscom)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ROMS Communication Toolbox (romscom)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              rcutils
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ROMS Communication Toolbox (romscom)" class="md-nav__button md-logo" aria-label="ROMS Communication Toolbox (romscom)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ROMS Communication Toolbox (romscom)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Information
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bio_toy_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A bio_toy sensitivity study
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_romscom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    romscom
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    rcutils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    rcutils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils" class="md-nav__link">
    <span class="md-ellipsis">
      rcutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.bool2str" class="md-nav__link">
    <span class="md-ellipsis">
      bool2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.checkforstring" class="md-nav__link">
    <span class="md-ellipsis">
      checkforstring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.consecutive" class="md-nav__link">
    <span class="md-ellipsis">
      consecutive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.fieldsaretime" class="md-nav__link">
    <span class="md-ellipsis">
      fieldsaretime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.findclosesttime" class="md-nav__link">
    <span class="md-ellipsis">
      findclosesttime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      flatten
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.float2str" class="md-nav__link">
    <span class="md-ellipsis">
      float2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.formatkeyvalue" class="md-nav__link">
    <span class="md-ellipsis">
      formatkeyvalue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.inputfilesexist" class="md-nav__link">
    <span class="md-ellipsis">
      inputfilesexist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.list2str" class="md-nav__link">
    <span class="md-ellipsis">
      list2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.multifile2str" class="md-nav__link">
    <span class="md-ellipsis">
      multifile2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.ordered_load" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_load
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.parseromslog" class="md-nav__link">
    <span class="md-ellipsis">
      parseromslog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.parserst" class="md-nav__link">
    <span class="md-ellipsis">
      parserst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.timefieldlist" class="md-nav__link">
    <span class="md-ellipsis">
      timefieldlist
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils" class="md-nav__link">
    <span class="md-ellipsis">
      rcutils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.bool2str" class="md-nav__link">
    <span class="md-ellipsis">
      bool2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.checkforstring" class="md-nav__link">
    <span class="md-ellipsis">
      checkforstring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.consecutive" class="md-nav__link">
    <span class="md-ellipsis">
      consecutive
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.fieldsaretime" class="md-nav__link">
    <span class="md-ellipsis">
      fieldsaretime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.findclosesttime" class="md-nav__link">
    <span class="md-ellipsis">
      findclosesttime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.flatten" class="md-nav__link">
    <span class="md-ellipsis">
      flatten
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.float2str" class="md-nav__link">
    <span class="md-ellipsis">
      float2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.formatkeyvalue" class="md-nav__link">
    <span class="md-ellipsis">
      formatkeyvalue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.inputfilesexist" class="md-nav__link">
    <span class="md-ellipsis">
      inputfilesexist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.list2str" class="md-nav__link">
    <span class="md-ellipsis">
      list2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.multifile2str" class="md-nav__link">
    <span class="md-ellipsis">
      multifile2str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.ordered_load" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_load
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.parseromslog" class="md-nav__link">
    <span class="md-ellipsis">
      parseromslog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.parserst" class="md-nav__link">
    <span class="md-ellipsis">
      parserst
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#romscom.rcutils.timefieldlist" class="md-nav__link">
    <span class="md-ellipsis">
      timefieldlist
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>rcutils</h1>

<div class="doc doc-object doc-module">



<a id="romscom.rcutils"></a>
    <div class="doc doc-contents first">

        <p><strong>ROMS Communication Module utility functions</strong></p>
<p>This module provides a number of small helper functions used by the primary romscom
functions.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.bool2str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bool2str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Formats input boolean as string 'T' or 'F'</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'T' or 'F', corresponding to True or False, respectively</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bool2str</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formats input boolean as string &#39;T&#39; or &#39;F&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        x (logical)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (string): &#39;T&#39; or &#39;F&#39;, corresponding to True or False, respectively</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.checkforstring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkforstring</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check that all dictionary entries have been stringified, and print the keys cooresponding
to non-stringified values (primary diagnostic)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROMS parameter dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>prefix applied to printout of non-stringified value's key</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">checkforstring</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check that all dictionary entries have been stringified, and print the keys cooresponding</span>
<span class="sd">    to non-stringified values (primary diagnostic)</span>

<span class="sd">    Args:</span>
<span class="sd">        x (dict): ROMS parameter dictionary</span>
<span class="sd">        prefix (string, optional): prefix applied to printout of non-stringified value&#39;s key</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ky</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">checkforstring</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ky</span><span class="p">],</span> <span class="n">ky</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ky</span><span class="p">],</span> <span class="p">(</span><span class="nb">str</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ky</span><span class="p">],</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="n">ky</span><span class="p">])))):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">ky</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.consecutive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">consecutive</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Groups values in list based on difference between consecutive elements</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of numeric values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stepsize</code>
            </td>
            <td>
                  <code><span title="numeric">numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>difference between consecutive elements to use for
grouping. Default = 0, i.e. identical values grouped</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list of lists</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>values grouped.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<pre><code>&gt;&gt;&gt; consecutive([1, 1, 1, 2, 2, 4, 5])
[[1, 1, 1], [2, 2], [4], [5]]

&gt;&gt;&gt; consecutive([1, 1, 1, 2, 2, 4, 5], 1)
[[1], [1], [1, 2], [2], [4, 5]]
</code></pre>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">consecutive</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Groups values in list based on difference between consecutive elements</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list): list of numeric values</span>
<span class="sd">        stepsize (numeric): difference between consecutive elements to use for</span>
<span class="sd">            grouping. Default = 0, i.e. identical values grouped</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list of lists): values grouped.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; consecutive([1, 1, 1, 2, 2, 4, 5])</span>
<span class="sd">        [[1, 1, 1], [2, 2], [4], [5]]</span>

<span class="sd">        &gt;&gt;&gt; consecutive([1, 1, 1, 2, 2, 4, 5], 1)</span>
<span class="sd">        [[1], [1], [1, 2], [2], [4, 5]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="n">stepsize</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tmp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.fieldsaretime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fieldsaretime</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>True if all time-related fields are in datetime/timedelta format</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>parameter dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="boolean">boolean</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all time-related fields are in datetime/timedelta
format, False if all are numeric.  </p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if a mix of numeric and datetime/timedelta values are found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fieldsaretime</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    True if all time-related fields are in datetime/timedelta format</span>

<span class="sd">    Args:</span>
<span class="sd">        d (dict): parameter dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        (boolean): True if all time-related fields are in datetime/timedelta</span>
<span class="sd">            format, False if all are numeric.  </span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: if a mix of numeric and datetime/timedelta values are found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timeflds</span> <span class="o">=</span> <span class="n">timefieldlist</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="n">isnum</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;DT&#39;</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;DSTART&#39;</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timeflds</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;TIME_REF&#39;</span><span class="p">],</span> <span class="nb">float</span><span class="p">)</span>

    <span class="n">istime</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;DT&#39;</span><span class="p">],</span> <span class="n">timedelta</span><span class="p">)</span> <span class="ow">and</span> \
             <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;DSTART&#39;</span><span class="p">],</span> <span class="n">datetime</span><span class="p">)</span> <span class="ow">and</span> \
             <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">timedelta</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timeflds</span><span class="p">)</span> <span class="ow">and</span> \
             <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;TIME_REF&#39;</span><span class="p">],</span> <span class="n">datetime</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isnum</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="n">istime</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unexpected data types in time-related fields&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.findclosesttime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">findclosesttime</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">targetdate</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;*his*.nc&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Search folder for history file with time closest to the target date</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>folder</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pathname to folder holding output of a BESTNPZ ROMS
simulation, with history files matching the pattern provided.
Alternatively, can be a list of history filenames (useful if you
want to include a smaller subset from within a folder that can't be
isolated via pattern)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>targetdate</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>target date</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pattern</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pattern-matching string appended to folder name
as search string to identify history files Default = '<em>his</em>.nc'</p>
              </div>
            </td>
            <td>
                  <code>&#39;*his*.nc&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with the following keys/values:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value type</th>
<th>Value description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code>string</code></td>
<td>full path to history file including nearest date</td>
</tr>
<tr>
<td><code>idx</code></td>
<td><code>int</code></td>
<td>time index within that file (0-based) of nearest date</td>
</tr>
<tr>
<td><code>dt</code></td>
<td><code>timedelta</code></td>
<td>time between nearest date and target date</td>
</tr>
<tr>
<td><code>unit</code></td>
<td><code>string</code></td>
<td>time units used in history file</td>
</tr>
<tr>
<td><code>cal</code></td>
<td><code>string</code></td>
<td>calendar used by history file</td>
</tr>
</tbody>
</table>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">findclosesttime</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">targetdate</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;*his*.nc&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search folder for history file with time closest to the target date</span>

<span class="sd">    Args:</span>
<span class="sd">        folder (string): pathname to folder holding output of a BESTNPZ ROMS</span>
<span class="sd">            simulation, with history files matching the pattern provided.</span>
<span class="sd">            Alternatively, can be a list of history filenames (useful if you</span>
<span class="sd">            want to include a smaller subset from within a folder that can&#39;t be</span>
<span class="sd">            isolated via pattern)</span>
<span class="sd">        targetdate (datetime): target date</span>
<span class="sd">        pattern (string): pattern-matching string appended to folder name</span>
<span class="sd">            as search string to identify history files Default = &#39;*his*.nc&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): with the following keys/values:</span>

<span class="sd">            Key       |Value type  |Value description</span>
<span class="sd">            ---       |----------  |-----------------</span>
<span class="sd">            `filename`|`string`    |full path to history file including nearest date</span>
<span class="sd">            `idx`     |`int`       |time index within that file (0-based) of nearest date</span>
<span class="sd">            `dt`      |`timedelta` |time between nearest date and target date</span>
<span class="sd">            `unit`    |`string`    |time units used in history file</span>
<span class="sd">            `cal`     |`string`    |calendar used by history file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
        <span class="n">hisfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hisfiles</span> <span class="o">=</span> <span class="n">folder</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">hisfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">tunit</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ocean_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
    <span class="n">tcal</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ocean_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">calendar</span>

    <span class="n">dtmin</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">hisfiles</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ocean_time&#39;</span><span class="p">][:],</span> <span class="n">units</span><span class="o">=</span><span class="n">tunit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="n">tcal</span><span class="p">)</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="n">targetdate</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]]</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]:</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dt</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]]</span>
                    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tunit</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;cal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tcal</span>

    <span class="k">return</span> <span class="n">d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flatten</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Recursively flatten a list of lists (of lists of lists...)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list that may contains nested lists</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>contents of A where all sub-lists have been flattened to a single
level</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively flatten a list of lists (of lists of lists...)</span>

<span class="sd">    Args:</span>
<span class="sd">        A (list): list that may contains nested lists</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list): contents of A where all sub-lists have been flattened to a single</span>
<span class="sd">            level</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rt</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span> <span class="n">rt</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">rt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.float2str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">float2str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Formats input float as Fortran-style double-precision string</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x in Fortran double-precision syntax (e.g., "1.0d0")</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">float2str</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formats input float as Fortran-style double-precision string</span>

<span class="sd">    Args:</span>
<span class="sd">        x (float): input value</span>

<span class="sd">    Returns:</span>
<span class="sd">        (string): x in Fortran double-precision syntax (e.g., &quot;1.0d0&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
    <span class="c1"># if not any(x in y for x in [&#39;d&#39;,&#39;.&#39;]):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">d0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.formatkeyvalue" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">formatkeyvalue</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">singular</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Format dictionary entries as ROMS parameter assignments</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kw</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>stringified value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>singular</code>
            </td>
            <td>
                  <code>list of strings</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of keys that should be treated as
unvarying across ROMS grids (i.e. uses a = assignment vs ==)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>key/value as a line of text, e.g. 'key == value'</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">formatkeyvalue</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">singular</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Format dictionary entries as ROMS parameter assignments</span>

<span class="sd">    Args:</span>
<span class="sd">        kw (string): key</span>
<span class="sd">        val (string): stringified value</span>
<span class="sd">        singular (list of strings): list of keys that should be treated as</span>
<span class="sd">            unvarying across ROMS grids (i.e. uses a = assignment vs ==)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (string): key/value as a line of text, e.g. &#39;key == value&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">singular</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> == </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.inputfilesexist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inputfilesexist</span><span class="p">(</span><span class="n">ocean</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Check that all ROMS input files exist.  If a filename starts with the string
"placeholder", it is ignored in this check (this allows you to keep unused
parameters in the YAML files, but clearly indicates that these files will
not be required)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ocean</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROMS parameter dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="boolean">boolean</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all files exist (or are marked as placeholders),
False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inputfilesexist</span><span class="p">(</span><span class="n">ocean</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check that all ROMS input files exist.  If a filename starts with the string</span>
<span class="sd">    &quot;placeholder&quot;, it is ignored in this check (this allows you to keep unused</span>
<span class="sd">    parameters in the YAML files, but clearly indicates that these files will</span>
<span class="sd">    not be required)</span>

<span class="sd">    Args:</span>
<span class="sd">        ocean (dict): ROMS parameter dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        (boolean): True if all files exist (or are marked as placeholders),</span>
<span class="sd">            False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fkey</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GRDNAME&#39;</span><span class="p">,</span><span class="s1">&#39;ININAME&#39;</span><span class="p">,</span><span class="s1">&#39;ITLNAME&#39;</span><span class="p">,</span><span class="s1">&#39;IRPNAME&#39;</span><span class="p">,</span><span class="s1">&#39;IADNAME&#39;</span><span class="p">,</span><span class="s1">&#39;FWDNAME&#39;</span><span class="p">,</span>
           <span class="s1">&#39;ADSNAME&#39;</span><span class="p">,</span><span class="s1">&#39;FOInameA&#39;</span><span class="p">,</span><span class="s1">&#39;FOInameB&#39;</span><span class="p">,</span><span class="s1">&#39;FCTnameA&#39;</span><span class="p">,</span><span class="s1">&#39;FCTnameB&#39;</span><span class="p">,</span><span class="s1">&#39;NGCNAME&#39;</span><span class="p">,</span>
           <span class="s1">&#39;CLMNAME&#39;</span><span class="p">,</span><span class="s1">&#39;BRYNAME&#39;</span><span class="p">,</span><span class="s1">&#39;NUDNAME&#39;</span><span class="p">,</span><span class="s1">&#39;SSFNAME&#39;</span><span class="p">,</span><span class="s1">&#39;TIDENAME&#39;</span><span class="p">,</span><span class="s1">&#39;FRCNAME&#39;</span><span class="p">,</span>
           <span class="s1">&#39;APARNAM&#39;</span><span class="p">,</span><span class="s1">&#39;SPOSNAM&#39;</span><span class="p">,</span><span class="s1">&#39;FPOSNAM&#39;</span><span class="p">,</span><span class="s1">&#39;IPARNAM&#39;</span><span class="p">,</span><span class="s1">&#39;BPARNAM&#39;</span><span class="p">,</span><span class="s1">&#39;SPARNAM&#39;</span><span class="p">,</span>
           <span class="s1">&#39;USRNAME&#39;</span><span class="p">]</span>

    <span class="n">rem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fkey</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ocean</span><span class="p">:</span>
            <span class="n">rem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">fkey</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fkey</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rem</span><span class="p">]</span>

    <span class="n">files</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">([</span><span class="n">ocean</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fkey</span><span class="p">])</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;placeholder&#39;</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find file </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.list2str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list2str</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">consecstep</span><span class="o">=-</span><span class="mi">99999</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert list of bools, floats, or integers to string</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tmp</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of either all bools, all floats, all integers, or all
strings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>consecstep</code>
            </td>
            <td>
                  <code><span title="numeric">numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>step size to use for compression.
Default = -99999, i.e. no compression; use 0 for ROMS-style
compression (i.e. T T T F -&gt; 3*T F).  Not applicable to string lists.</p>
              </div>
            </td>
            <td>
                  <code>-99999</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROMS-appropriate string version of list values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list2str</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">consecstep</span><span class="o">=-</span><span class="mi">99999</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert list of bools, floats, or integers to string</span>

<span class="sd">    Args:</span>
<span class="sd">        tmp (list): a list of either all bools, all floats, all integers, or all</span>
<span class="sd">            strings</span>
<span class="sd">        consecstep (numeric): step size to use for compression.</span>
<span class="sd">            Default = -99999, i.e. no compression; use 0 for ROMS-style</span>
<span class="sd">            compression (i.e. T T T F -&gt; 3*T F).  Not applicable to string lists.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (string): ROMS-appropriate string version of list values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">)</span> <span class="ow">or</span>
            <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">)</span> <span class="ow">or</span>
            <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">)</span> <span class="ow">or</span>
            <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>   <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">)):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mixed data types found in list (</span><span class="si">{</span><span class="n">tmp</span><span class="si">}</span><span class="s2">); skipping string conversion&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tmp</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="n">consec</span> <span class="o">=</span> <span class="n">consecutive</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="n">consecstep</span><span class="p">)</span>

        <span class="n">consecstr</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">consec</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">consec</span><span class="p">)):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">consec</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">sampleval</span> <span class="o">=</span> <span class="n">float2str</span><span class="p">(</span><span class="n">consec</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">sampleval</span> <span class="o">=</span> <span class="n">bool2str</span><span class="p">(</span><span class="n">consec</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sampleval</span> <span class="o">=</span> <span class="n">consec</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">consecstr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{num}</span><span class="s1">*</span><span class="si">{val}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">sampleval</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">consecstr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{val}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="o">=</span><span class="n">sampleval</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">consecstr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.multifile2str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multifile2str</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a multifile list of filenames (with possible nesting) to string</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tmp</code>
            </td>
            <td>
                  <code>string or list of strings</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>names of files and multi-files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROMS multi-file formatted as string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">multifile2str</span><span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a multifile list of filenames (with possible nesting) to string</span>

<span class="sd">    Args:</span>
<span class="sd">        tmp (string or list of strings): names of files and multi-files</span>

<span class="sd">    Returns:</span>
<span class="sd">        (string): ROMS multi-file formatted as string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">delim</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; |</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tmp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">delim</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

    <span class="n">delim</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="se">\\\n</span><span class="s2">&quot;</span>
    <span class="n">newstr</span> <span class="o">=</span> <span class="n">delim</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newstr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.ordered_load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ordered_load</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function was pulled from https://stackoverflow.com/questions/5121931/.
It makes sure YAML dictionary loads preserve order, even in older
versions of python.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stream</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input stream</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loader</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>loader (default: yaml.SafeLoader)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>usage example:
ordered_load(stream, yaml.SafeLoader)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.OrderedDict">OrderedDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ordered_load</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function was pulled from https://stackoverflow.com/questions/5121931/.</span>
<span class="sd">    It makes sure YAML dictionary loads preserve order, even in older</span>
<span class="sd">    versions of python.</span>

<span class="sd">    Args:</span>
<span class="sd">        stream: input stream</span>
<span class="sd">        loader: loader (default: yaml.SafeLoader)</span>

<span class="sd">    usage example:</span>
<span class="sd">    ordered_load(stream, yaml.SafeLoader)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (OrderedDict): dictionary</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">OrderedLoader</span><span class="p">(</span><span class="n">Loader</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">construct_mapping</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="n">loader</span><span class="o">.</span><span class="n">flatten_mapping</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">object_pairs_hook</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">construct_pairs</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
    <span class="n">OrderedLoader</span><span class="o">.</span><span class="n">add_constructor</span><span class="p">(</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">resolver</span><span class="o">.</span><span class="n">BaseResolver</span><span class="o">.</span><span class="n">DEFAULT_MAPPING_TAG</span><span class="p">,</span>
        <span class="n">construct_mapping</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">OrderedLoader</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.parseromslog" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parseromslog</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse ROMS standard output log for some details about the success (or not) of a ROMS
simulation</p>
<p>Args
    fname (string): name of file with ROMS standard output</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with the following fields:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value type</th>
<th>Value description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cleanrun</code></td>
<td><code>boolean</code></td>
<td>True if simulation ran without errors</td>
</tr>
<tr>
<td><code>blowup</code></td>
<td><code>boolean</code></td>
<td>True if simulation blew up</td>
</tr>
<tr>
<td><code>laststep</code></td>
<td><code>int</code></td>
<td>Index of last step recorded</td>
</tr>
<tr>
<td><code>lasthis</code></td>
<td><code>string</code></td>
<td>Name of last history file defined</td>
</tr>
</tbody>
</table>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parseromslog</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse ROMS standard output log for some details about the success (or not) of a ROMS</span>
<span class="sd">    simulation</span>

<span class="sd">    Args</span>
<span class="sd">        fname (string): name of file with ROMS standard output</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): dictionary with the following fields:</span>

<span class="sd">            Key        |Value type|Value description</span>
<span class="sd">            -----------|----------|-----------------</span>
<span class="sd">            `cleanrun` |`boolean` | True if simulation ran without errors</span>
<span class="sd">            `blowup`   |`boolean` | True if simulation blew up</span>
<span class="sd">            `laststep` |`int`     | Index of last step recorded</span>
<span class="sd">            `lasthis`  |`string`  | Name of last history file defined</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">lnnum</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ROMS/TOMS: DONE&#39;</span><span class="p">)</span>
        <span class="n">cleanrun</span> <span class="o">=</span> <span class="n">lnnum</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">lnnum1</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Blowing-up: Saving latest model state into  RESTART file&#39;</span><span class="p">)</span>
        <span class="n">lnnum2</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;MAIN: Abnormal termination: BLOWUP&#39;</span><span class="p">)</span>
        <span class="n">blowup</span> <span class="o">=</span> <span class="p">(</span><span class="n">lnnum1</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">lnnum2</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lasthis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">cleanrun</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

            <span class="n">datablock</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;STEP   Day HH:MM:SS  KINETIC_ENRG   POTEN_ENRG    TOTAL_ENRG    NET_VOLUME&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">datablock</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Elapsed CPU time (seconds):&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">datablock</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">datablock</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c1">#string.split(line.strip())</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                        <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DEF_HIS&#39;</span><span class="p">:</span>
                        <span class="n">lasthis</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;cleanrun&#39;</span><span class="p">:</span> <span class="n">cleanrun</span><span class="p">,</span> <span class="s1">&#39;blowup&#39;</span><span class="p">:</span> <span class="n">blowup</span><span class="p">,</span> <span class="s1">&#39;laststep&#39;</span><span class="p">:</span> <span class="n">step</span><span class="p">,</span> <span class="s1">&#39;lasthis&#39;</span><span class="p">:</span><span class="n">lasthis</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.parserst" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parserst</span><span class="p">(</span><span class="n">filebase</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse restart counters from ROMS simulation restart files</p>
<p>This function finds the name of, and parses the simulation counter,
from a series of ROMS restart files.  It assumes that those files
were using the naming scheme from runtodate, i.e. filebase_XX_rst.nc
where XX is the counter for number of restarts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filebase</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>base name for restart files (can include full path)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with the following keys:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value type</th>
<th>Value description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lastfile</code></td>
<td><code>string</code></td>
<td>full path to last restart file</td>
</tr>
<tr>
<td><code>cnt</code></td>
<td><code>int</code></td>
<td>restart counter of last file incremented by 1 (i.e. count you would want to restart with in runtodate)</td>
</tr>
</tbody>
</table>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parserst</span><span class="p">(</span><span class="n">filebase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse restart counters from ROMS simulation restart files</span>

<span class="sd">    This function finds the name of, and parses the simulation counter,</span>
<span class="sd">    from a series of ROMS restart files.  It assumes that those files</span>
<span class="sd">    were using the naming scheme from runtodate, i.e. filebase_XX_rst.nc</span>
<span class="sd">    where XX is the counter for number of restarts.</span>

<span class="sd">    Args:</span>
<span class="sd">        filebase (string): base name for restart files (can include full path)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): with the following keys:</span>

<span class="sd">            Key        |Value type|Value description</span>
<span class="sd">            -----------|----------|-----------------</span>
<span class="sd">            `lastfile` |`string`  |full path to last restart file</span>
<span class="sd">            `cnt`      |`int`     |restart counter of last file incremented by 1 (i.e. count you would want to restart with in runtodate)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">allrst</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filebase</span> <span class="o">+</span> <span class="s2">&quot;_??_rst.nc&quot;</span><span class="p">)))</span>

    <span class="c1"># If a process crashes between the def_rst call and the first wrt_rst,</span>
    <span class="c1"># we&#39;re left with a .rst file with 0-length time dimension.  If that happens,</span>
    <span class="c1"># we need to back up one counter</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">allrst</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">allrst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ocean_time&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">allrst</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="c1"># Parse counter data from last rst file</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allrst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="n">rst</span> <span class="o">=</span> <span class="n">allrst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">pattern</span> <span class="o">=</span> <span class="n">filebase</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;_(\d+)_rst.nc&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">rst</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;lastfile&#39;</span><span class="p">:</span> <span class="n">rst</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">cnt</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="romscom.rcutils.timefieldlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timefieldlist</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Get list of time-related dictionary keys</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ROMS parameter dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list of strings</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keys in d that are time-related</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/romscom/rcutils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">timefieldlist</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get list of time-related dictionary keys</span>

<span class="sd">    Args:</span>
<span class="sd">        d (dict): ROMS parameter dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        (list of strings): keys in d that are time-related</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">timeflds</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NTIMES&#39;</span><span class="p">,</span> <span class="s1">&#39;NTIMES_ANA&#39;</span><span class="p">,</span> <span class="s1">&#39;NTIMES_FCT&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NRST&#39;</span><span class="p">,</span> <span class="s1">&#39;NSTA&#39;</span><span class="p">,</span> <span class="s1">&#39;NFLT&#39;</span><span class="p">,</span> <span class="s1">&#39;NINFO&#39;</span><span class="p">,</span> <span class="s1">&#39;NHIS&#39;</span><span class="p">,</span> <span class="s1">&#39;NAVG&#39;</span><span class="p">,</span> <span class="s1">&#39;NAVG2&#39;</span><span class="p">,</span> <span class="s1">&#39;NDIA&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NQCK&#39;</span><span class="p">,</span> <span class="s1">&#39;NTLM&#39;</span><span class="p">,</span> <span class="s1">&#39;NADJ&#39;</span><span class="p">,</span> <span class="s1">&#39;NSFF&#39;</span><span class="p">,</span> <span class="s1">&#39;NOBC&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NDEFHIS&#39;</span><span class="p">,</span> <span class="s1">&#39;NDEFQCK&#39;</span><span class="p">,</span> <span class="s1">&#39;NDEFAVG&#39;</span><span class="p">,</span> <span class="s1">&#39;NDEFDIA&#39;</span><span class="p">,</span> <span class="s1">&#39;NDEFTLM&#39;</span><span class="p">,</span> <span class="s1">&#39;NDEFADJ&#39;</span><span class="p">]</span>

    <span class="n">rem</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timeflds</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">rem</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">timeflds</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timeflds</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rem</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">timeflds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.footnote.tooltips", "navigation.sections"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>