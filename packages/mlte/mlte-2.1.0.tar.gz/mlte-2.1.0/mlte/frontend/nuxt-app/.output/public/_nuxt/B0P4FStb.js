import{j as R,k as V,l as A,r as _,n as h,q as w,w as o,A as T,m as q,o as v,a as y,v as b,c as F,b as m,t as z,s as a,d as s,z as E,C as S}from"./DenydyMN.js";import{c as $,i as j}from"./0wQYiv8f.js";import{u as I,r as D}from"./hPHynIdq.js";import{h as G,r as H}from"./Ch47lW9D.js";import"./Ch7Mx1Yh.js";const L=y("title",null,"Edit Profile",-1),X={class:"section-header",style:{display:"inline"}},J={key:2},K={class:"submit-footer"},ee=R({__name:"profile-edit",async setup(M){let c,C;const P=q(),k=V("token"),g=V("user"),{data:l}=([c,C]=A(()=>I(P.public.apiPath+"/user/me",{retry:0,method:"GET",headers:{Authorization:"Bearer "+k.value}},"$jr14E7zgXS")),c=await c,C(),c),u=_(!1),n=_(""),i=_(""),d=_({password:!1,confirmPassword:!1});function x(){n.value="",i.value="",u.value=!0}function B(){u.value=!1,n.value="",i.value=""}async function U(){d.value=D(d.value);let f=!1;if(u.value&&(n.value.trim()===""&&(d.value.password=!0,f=!0),n.value!==i.value&&(d.value.confirmPassword=!0,f=!0)),f){j();return}try{const e={username:l.value.username,email:l.value.email,full_name:l.value.full_name,disabled:!1,role:l.value.role};u.value&&(e.password=n.value),await $fetch(P.public.apiPath+"/user",{retry:0,method:"PUT",headers:{Authorization:"Bearer "+k.value},body:e,onRequestError(){H()},onResponse({response:t}){t.ok&&S("/")},onResponseError({response:t}){G(t.status,t._data.error_description)}})}catch(e){console.log(e)}}return(f,e)=>{const t=h("UsaButton"),p=h("UsaTextInput"),N=T;return v(),w(N,{name:"base-layout"},{"page-title":o(()=>[s("Edit Profile")]),default:o(()=>[L,y("h2",X,z(a(g)),1),a(u)?b("",!0):(v(),w(t,{key:0,class:"secondary-button sub-header-float-button",onClick:x},{default:o(()=>[s(" Change Password ")]),_:1})),a(u)?(v(),w(t,{key:1,class:"secondary-button sub-header-float-button",onClick:B},{default:o(()=>[s(" Cancel Change ")]),_:1})):b("",!0),a(u)?(v(),F("div",J,[m(p,{modelValue:a(n),"onUpdate:modelValue":e[0]||(e[0]=r=>E(n)?n.value=r:null),error:a(d).password,type:"password"},{label:o(()=>[s(" New Password ")]),"error-message":o(()=>[s(" Password is required ")]),_:1},8,["modelValue","error"]),m(p,{modelValue:a(i),"onUpdate:modelValue":e[1]||(e[1]=r=>E(i)?i.value=r:null),error:a(d).confirmPassword,type:"password"},{label:o(()=>[s(" Confirm New Password ")]),"error-message":o(()=>[s(" Passwords to not match ")]),_:1},8,["modelValue","error"])])):b("",!0),m(p,{modelValue:a(l).email,"onUpdate:modelValue":e[2]||(e[2]=r=>a(l).email=r)},{label:o(()=>[s(" Email ")]),_:1},8,["modelValue"]),m(p,{modelValue:a(l).full_name,"onUpdate:modelValue":e[3]||(e[3]=r=>a(l).full_name=r)},{label:o(()=>[s(" Full Name ")]),_:1},8,["modelValue"]),y("div",K,[m(t,{class:"primary-button",onClick:e[4]||(e[4]=r=>a($)("/"))},{default:o(()=>[s(" Cancel ")]),_:1}),m(t,{class:"primary-button",onClick:e[5]||(e[5]=r=>U())},{default:o(()=>[s(" Save ")]),_:1})])]),_:1})}}});export{ee as default};
