Metadata-Version: 2.4
Name: dig-flask-serve
Version: 1.1.0
Summary: A lightweight and pluggable model serving framework based on Flask.
Home-page: https://gitee.com/buaa717/dig-flask-serve.git
Author: zsj
Author-email: zhaishujie2@buaa.edu.cn
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: flask>=2.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# dig-flask-serve

ä¸€ä¸ªè½»é‡çº§ Flask æ¨¡å‹å‘å¸ƒæ¡†æ¶ï¼Œæ”¯æŒå¤šæ¨¡å‹ã€å¤šçº¿ç¨‹ã€é«˜å¯é…ç½®çš„æ¨¡å‹æ¥å£å‘å¸ƒå·¥å…·ã€‚

## å¿«é€Ÿå¼€å§‹


ğŸ“¦ å®‰è£…æ–¹å¼
åœ¨çº¿å®‰è£…ï¼ˆæ¨èï¼‰ï¼š
```bash
pip install dig-flask-serve
python examples/user_model_publish.py
```
ç¦»çº¿å®‰è£…ï¼ˆé€šè¿‡ .whl åŒ…ï¼‰ï¼š
```bash
pip install dig_flask_serve-0.1.0-py3-none-any.whl
```
ğŸš€ å¯åŠ¨æ–¹å¼
ä½¿ç”¨å†…ç½®ç¤ºä¾‹è„šæœ¬å¿«é€Ÿå‘å¸ƒå¤šä¸ªæ¨¡å‹æ¥å£ï¼š
```bash
python model_publishing_example.py

from dig_flask_serve import dig_flask, BaseModelHandler
import time

# ç¤ºä¾‹æ¨¡å‹ 1
class Model1Handler(BaseModelHandler):
    #æ¨¡å‹åŠ è½½
    def init_model(self):
        print("Initializing Model1 ...")
        self.model = 42
    #æ¨¡å‹è°ƒç”¨
    def predict(self, input_data):
        x = input_data.get('x', 0)
        time.sleep(1)  # æ¨¡æ‹Ÿè®¡ç®—è€—æ—¶
        return x + self.model

# ç¤ºä¾‹æ¨¡å‹ 2
class Model2Handler(BaseModelHandler):
    #æ¨¡å‹åŠ è½½
    def init_model(self):
        print("Initializing Model2 ...")
        self.model = 3.14
    #æ¨¡å‹è°ƒç”¨
    def predict(self, input_data):
        x = input_data.get('x', 0)
        time.sleep(0.5)
        return x * self.model

# åˆ›å»ºåº”ç”¨å¹¶æ³¨å†Œæ¨¡å‹
flask_app = dig_flask()
# åˆ›å»ºå¯¹åº”çº¿ç¨‹æ•°ï¼Œä¸æŒ‡å®šé»˜è®¤ä¸º16
flask_app.enable_thread_pool(max_workers=16)
# å£°æ˜å¯¹å¤–è®¿é—®æ¥å£ä»¥åŠå¯¹åº”çš„è¯·æ±‚æ–¹å¼
flask_app.register_model(Model1Handler(), url='/predict/model1', methods=['POST'])
flask_app.register_model(Model2Handler(), url='/predict/model2', methods=['POST'])

# å¯åŠ¨æœåŠ¡ï¼ˆé»˜è®¤æ”¯æŒå¤šçº¿ç¨‹ï¼‰
flask_app.run(port=7000)
```
è¿è¡Œåè¾“å‡ºç¤ºä¾‹ï¼š
```bash
Initializing Model1 ...
Initializing Model2 ...
 * Serving Flask app 'dig_flask_serve.dig_flask'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:7000
 * Running on http://10.134.11.225:7000
 ```
ğŸ”— æ¥å£è®¿é—®è¯´æ˜

ğŸ›  åœ¨çº¿æµ‹è¯•å·¥å…·é¡µé¢ï¼š
ğŸ‘‰ http://127.0.0.1:7000

![é€šç”¨æ¨¡å‹æ¥å£æµ‹è¯•å·¥å…·](https://digbuaa.oss-cn-beijing.aliyuncs.com/zsj/git/2b4001e1219f49798b13240edb3607de.png)
