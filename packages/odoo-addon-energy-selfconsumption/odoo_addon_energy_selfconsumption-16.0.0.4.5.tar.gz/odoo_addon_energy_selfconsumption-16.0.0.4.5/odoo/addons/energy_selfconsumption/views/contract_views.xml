<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <record id="contract_tree_view" model="ir.ui.view">
            <field name="name">energy_selfconsumption.contract.tree</field>
            <field name="model">contract.contract</field>
            <field name="arch" type="xml">
                <tree string="Contracts" expand="1">
                    <field name="partner_id" />
                    <field name="supply_point_name" />
                    <field name="code" />
                    <field name="next_period_date_start" />
                    <field name="next_period_date_end" />
                    <field name="last_period_date_start" />
                    <field name="last_period_date_end" />
                </tree>
            </field>

        </record>
        <record id="contract_search_view" model="ir.ui.view">
            <field name="name">energy_selfconsumption.contract.search</field>
            <field name="model">contract.contract</field>
            <field name="inherit_id" ref="contract.contract_contract_search_view" />
            <field name="arch" type="xml">
                <xpath expr="/search" position="inside">
                    <group expand="1" string="Group By">
                      <filter
                        string="Next Period Date Start"
                        name="filter_next_period_date_end"
                        domain="[]"
                        context="{'group_by':'next_period_date_end'}"
                      />
                    </group>
                </xpath>
            </field>
        </record>

        <record id="contract_invoicing_wizard_action" model="ir.actions.server">
            <field name="name">Generate invoices</field>
            <field name="model_id" ref="model_contract_contract" />
            <field name="binding_model_id" ref="contract.model_contract_contract" />
            <field name="binding_type">action</field>
            <field name="binding_view_types">list,form</field>
            <field name="groups_id" eval="[(4,ref('energy_project.group_admin'))]" />
            <field name="state">code</field>
            <field name="code">action = records.invoicing_wizard_action()</field>
        </record>

        <!-- <report
      id="contract_contract_csv_report"
      model="contract.contract"
      string="Customized delivered energy template"
      report_type="csv"
      name="contract_contract.csv"
      file="contract_contract"
      attachment_use="False"
    /> -->
        <record id="contract_contract_csv_report" model="ir.actions.report">
            <field name="name">Customized delivered energy template</field>
            <field name="model">contract.contract</field>
            <field name="report_type">csv</field>
            <field name="report_name">contract_contract.csv</field>
            <field name="report_file">contract_contract</field>
            <field name="binding_model_id" ref="contract.model_contract_contract" />
            <field name="binding_type">report</field>
        </record>

      <record id="view_contract_contract_customer_form_platform_admin" model="ir.ui.view">
        <field name="name">contract.contract.form (in selfconsumption platform admin)</field>
        <field name="model">contract.contract</field>
        <field name="inherit_id" ref="energy_communities_service_invoicing.view_contract_contract_customer_form_platform_admin" />
        <field name="arch" type="xml">
          <xpath expr="//field[@name='partner_id']" position="after">
            <field name="project_id" attrs="{'invisible': [('pack_type','!=','selfconsumption_pack')]}"/>
            <field name="supply_point_assignation_id" attrs="{'invisible': [('pack_type','!=','selfconsumption_pack')]}"/>
          </xpath>
        </field>
      </record>

    </data>
</odoo>
