<odoo>
        <template id="selfconsumption_invoice_template" inherit_id="account.report_invoice_document">
            <xpath expr="//th[@name='th_quantity']" position="replace">
                <th name="th_quantity" t-if="o.selfconsumption_invoicing_mode == 'none'" class="text-end"><span>Quantity</span></th>
                <th name="th_quantity" t-if="o.selfconsumption_invoicing_mode == 'power_acquired'" class="text-end"><span>Quantity</span></th>
                <t t-if="o.selfconsumption_invoicing_mode == 'energy_delivered'">
                    <th name="th_total_installation_generation" class="text-end"><span>Total installation generation</span></th>
                    <th name="th_partition_coefficient" class="text-end"><span>Partition coefficient</span></th>
                    <th name="th_total_amount_invoiced" class="text-end"><span>Total amount invoiced</span></th>
                </t>
            </xpath>
            <xpath expr="//th[@name='th_priceunit']" position="after">
                <t t-if="o.selfconsumption_invoicing_mode == 'power_acquired'">
                    <th name="th_import" class="text-end"><span>Import</span></th>
                </t>
                <t t-if="o.selfconsumption_invoicing_mode == 'energy_delivered'">
                    <th name="th_import" class="text-end"><span>Import</span></th>
                </t>
            </xpath>
            <xpath expr="//th[@name='th_taxes']" position="replace">
                <th name="th_taxes" t-if="o.selfconsumption_invoicing_mode == 'none'" t-attf-class="text-start {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Taxes</span></th>
            </xpath> 
            <xpath expr="//th[@name='th_subtotal']" position="replace">
                <th name="th_subtotal" t-if="o.selfconsumption_invoicing_mode == 'none'" class="text-end">
                    <span groups="account.group_show_line_subtotals_tax_excluded">Amount</span>
                    <span groups="account.group_show_line_subtotals_tax_included">Total Price</span>
                </th>
            </xpath>
            <xpath expr="//td[@name='account_invoice_line_name']" position="after">
                <t t-if="o.selfconsumption_invoicing_mode == 'energy_delivered'">
                    <td name="td_total_installation_generation" class="text-end">
                        <span t-field="line.selfconsumption_id.power"/><span> kWh</span>
                    </td>
                    <td name="td_partition_coefficient" class="text-end">
                        <t t-if="line.contract_line_id.contract_id.supply_point_assignation_id.coefficient">
                            <span t-field="line.contract_line_id.contract_id.supply_point_assignation_id.coefficient"/>
                        </t>
                    </td>
                </t>
            </xpath>
            <xpath expr="//td[@name='td_taxes']" position="replace">
                <td name="td_taxes" t-if="o.selfconsumption_invoicing_mode == 'none'" t-attf-class="text-start {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }} {{ 'text-nowrap' if len(taxes) &lt; 10 else '' }}">
                    <span t-out="taxes" id="line_tax_ids">Tax 15%</span>
                </td>
            </xpath>
            <xpath expr="//p[@name='payment_communication']" position="replace">
                <p t-if="o.move_type in ('out_invoice', 'in_refund') and o.payment_reference and o.payment_mode_id.payment_method_id.code != 'sepa_direct_debit'" name="payment_communication" class="mt-4">
                    Please use the following communication for your payment : <b><span t-field="o.payment_reference"/></b>
                    <t t-if="o.partner_bank_id">
                        <br/>
                        on this account: <span t-field="o.partner_bank_id" class="fw-bold"/>
                    </t>
                </p>
            </xpath>
        </template>
</odoo>
