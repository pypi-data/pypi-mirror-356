(()=>{var e={};e.id=329,e.ids=[329],e.modules={334:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l});var a=s(20863),r=s(38832),n=s(39682),i=s.n(n),o=s(11461),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(t,d);let l={children:["",{children:["datasets",{children:["[dataset_id]",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,87557)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/settings/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,37374)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,28950)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,94677)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,74595)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,14127)),"/Users/hanch/fal/lavender-data/ui/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,58206,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,63447,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,94716,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/settings/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/datasets/[dataset_id]/settings/page",pathname:"/datasets/[dataset_id]/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8041:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(40871),r=s(30618);let n=({icon:e,content:t})=>(0,a.jsxs)(r.Tooltip,{children:[(0,a.jsx)(r.TooltipTrigger,{asChild:!0,children:e}),(0,a.jsx)(r.TooltipContent,{children:t})]})},10839:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>h,L3:()=>x,c7:()=>p,lG:()=>o,rr:()=>m,zM:()=>d});var a=s(40871);s(65138);var r=s(32506),n=s(98154),i=s(75908);function o({...e}){return(0,a.jsx)(r.bL,{"data-slot":"dialog",...e})}function d({...e}){return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...e})}function l({...e}){return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...e})}function c({className:e,...t}){return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e),...t})}function u({className:e,children:t,...s}){return(0,a.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,a.jsx)(c,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,(0,a.jsxs)(r.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function p({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function h({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function x({className:e,...t}){return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",e),...t})}function m({className:e,...t}){return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",e),...t})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13804:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});var a=s(40871);s(65138);var r=s(8019),n=s(75908);function i({className:e,children:t,...s}){return(0,a.jsxs)(r.bL,{"data-slot":"scroll-area",className:(0,n.cn)("relative",e),...s,children:[(0,a.jsx)(r.LM,{"data-slot":"scroll-area-viewport",className:"ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1",children:t}),(0,a.jsx)(o,{}),(0,a.jsx)(r.OK,{})]})}function o({className:e,orientation:t="vertical",...s}){return(0,a.jsx)(r.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,n.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...s,children:(0,a.jsx)(r.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},17141:(e,t,s)=>{"use strict";s.d(t,{J:()=>i});var a=s(40871);s(65138);var r=s(44989),n=s(75908);function i({className:e,...t}){return(0,a.jsx)(r.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20574:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(21228).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},22393:(e,t,s)=>{"use strict";s.d(t,{DeleteDatasetDialog:()=>a});let a=(0,s(26259).registerClientReference)(function(){throw Error("Attempted to call DeleteDatasetDialog() from the server but DeleteDatasetDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/settings/delete-dataset-dialog.tsx","DeleteDatasetDialog")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},36285:(e,t,s)=>{Promise.resolve().then(s.bind(s,26219)),Promise.resolve().then(s.bind(s,22393)),Promise.resolve().then(s.bind(s,72336)),Promise.resolve().then(s.bind(s,44155))},44989:(e,t,s)=>{"use strict";s.d(t,{b:()=>o});var a=s(65138),r=s(34240),n=s(40871),i=a.forwardRef((e,t)=>(0,n.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var o=i},46458:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"40f53edd788e5c46de409b51a96321c91a49b5a4b7":()=>a.x,"70e6740d53bfa57b26358efdf6161a917f087aa338":()=>r.A});var a=s(48161),r=s(87110)},48161:(e,t,s)=>{"use strict";s.d(t,{Q:()=>p,x:()=>u});var a=s(94829),r=s(45290),n=s(12850),i=s(32253),o=s(61573),d=s(87110),l=s(72188),c=s(98612);let u=async function(e){var[t]=await (0,n.decryptActionBoundArgs)("40f53edd788e5c46de409b51a96321c91a49b5a4b7",e);let s=await (0,l.KU)(),a=await s.GET("/datasets/{dataset_id}",{params:{path:{dataset_id:t}}});if(a.error)return;let r=a.data.shardsets.map(e=>e.id);await Promise.all(r.map(e=>(0,d.A)(t,e,!1))),(0,c.redirect)("/background-tasks/")};async function p({dataset_id:e,shardsets:t}){let s=!!(await Promise.all(t.map(async t=>(await (0,l.KU)()).GET("/datasets/{dataset_id}/shardsets/{shardset_id}/sync",{params:{path:{dataset_id:e,shardset_id:t}}})))).find(e=>e.data&&"completed"!==e.data.status),d=(0,r.A)(u,"40f53edd788e5c46de409b51a96321c91a49b5a4b7",null).bind(null,(0,n.encryptActionBoundArgs)("40f53edd788e5c46de409b51a96321c91a49b5a4b7",e));return(0,a.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,a.jsx)("form",{action:d,children:(0,a.jsxs)(i.$,{type:"submit",className:"w-full",disabled:s,children:[(0,a.jsx)(o.A,{className:"w-4 h-4"}),"Sync"]})})})}},50149:(e,t,s)=>{"use strict";s.d(t,{PreprocessDatasetDialog:()=>es});var a=s(40871),r=s(65138),n=s(22384),i=s(15376),o=s(24983),d=s(21895),l=s(13804),c=s(33094),u=s(26123),p=s(10839),h=s(68491),x=s(17141),m=s(8041),f=s(68036),g=s(21228);let v=(0,g.A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var b=s(20574);let j=(0,g.A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var y=s(75908);function N({...e}){return(0,a.jsx)(f.Root,{"data-slot":"select",...e})}function w({...e}){return(0,a.jsx)(f.Value,{"data-slot":"select-value",...e})}function _({className:e,children:t,...s}){return(0,a.jsxs)(f.Trigger,{"data-slot":"select-trigger",className:(0,y.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[t,(0,a.jsx)(f.Icon,{asChild:!0,children:(0,a.jsx)(v,{className:"size-4 opacity-50"})})]})}function k({className:e,children:t,position:s="popper",...r}){return(0,a.jsx)(f.Portal,{children:(0,a.jsxs)(f.Content,{"data-slot":"select-content",className:(0,y.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r,children:[(0,a.jsx)(P,{}),(0,a.jsx)(f.Viewport,{className:(0,y.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),(0,a.jsx)(D,{})]})})}function C({className:e,children:t,...s}){return(0,a.jsxs)(f.Item,{"data-slot":"select-item",className:(0,y.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...s,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(f.ItemIndicator,{children:(0,a.jsx)(b.A,{className:"size-4"})})}),(0,a.jsx)(f.ItemText,{children:t})]})}function P({className:e,...t}){return(0,a.jsx)(f.ScrollUpButton,{"data-slot":"select-scroll-up-button",className:(0,y.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,a.jsx)(j,{className:"size-4"})})}function D({className:e,...t}){return(0,a.jsx)(f.ScrollDownButton,{"data-slot":"select-scroll-down-button",className:(0,y.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,a.jsx)(v,{className:"size-4"})})}var S=s(36931);let A=(0,S.createServerReference)("7f3e229e64fb29737787879fbf882b5c02753f43c3",S.callServer,void 0,S.findSourceMapURL,"preprocessDataset");var z=s(14343),E=s(47231),R=s(27642),U=s(19654),T=s(63354),G=s(84055),I=s(2104),L="Checkbox",[q,F]=(0,E.A)(L),[M,O]=q(L);function J(e){let{__scopeCheckbox:t,checked:s,children:n,defaultChecked:i,disabled:o,form:d,name:l,onCheckedChange:c,required:u,value:p="on",internal_do_not_use_render:h}=e,[x,m]=(0,U.i)({prop:s,defaultProp:i??!1,onChange:c,caller:L}),[f,g]=r.useState(null),[v,b]=r.useState(null),j=r.useRef(!1),y=!f||!!d||!!f.closest("form"),N={checked:x,disabled:o,setChecked:m,control:f,setControl:g,name:l,form:d,value:p,hasConsumerStoppedPropagationRef:j,required:u,defaultChecked:!Z(i)&&i,isFormControl:y,bubbleInput:v,setBubbleInput:b};return(0,a.jsx)(M,{scope:t,...N,children:"function"==typeof h?h(N):n})}var $="CheckboxTrigger",B=r.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:s,...n},i)=>{let{control:o,value:d,disabled:l,checked:c,required:u,setControl:p,setChecked:h,hasConsumerStoppedPropagationRef:x,isFormControl:m,bubbleInput:f}=O($,e),g=(0,z.s)(i,p),v=r.useRef(c);return r.useEffect(()=>{let e=o?.form;if(e){let t=()=>h(v.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[o,h]),(0,a.jsx)(I.sG.button,{type:"button",role:"checkbox","aria-checked":Z(c)?"mixed":c,"aria-required":u,"data-state":Q(c),"data-disabled":l?"":void 0,disabled:l,value:d,...n,ref:g,onKeyDown:(0,R.m)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,R.m)(s,e=>{h(e=>!!Z(e)||!e),f&&m&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})})});B.displayName=$;var K=r.forwardRef((e,t)=>{let{__scopeCheckbox:s,name:r,checked:n,defaultChecked:i,required:o,disabled:d,value:l,onCheckedChange:c,form:u,...p}=e;return(0,a.jsx)(J,{__scopeCheckbox:s,checked:n,defaultChecked:i,disabled:d,required:o,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B,{...p,ref:t,__scopeCheckbox:s}),e&&(0,a.jsx)(W,{__scopeCheckbox:s})]})})});K.displayName=L;var V="CheckboxIndicator",X=r.forwardRef((e,t)=>{let{__scopeCheckbox:s,forceMount:r,...n}=e,i=O(V,s);return(0,a.jsx)(G.C,{present:r||Z(i.checked)||!0===i.checked,children:(0,a.jsx)(I.sG.span,{"data-state":Q(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});X.displayName=V;var H="CheckboxBubbleInput",W=r.forwardRef(({__scopeCheckbox:e,...t},s)=>{let{control:n,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:d,required:l,disabled:c,name:u,value:p,form:h,bubbleInput:x,setBubbleInput:m}=O(H,e),f=(0,z.s)(s,m),g=function(e){let t=r.useRef({value:e,previous:e});return r.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(o),v=(0,T.X)(n);r.useEffect(()=>{if(!x)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!i.current;if(g!==o&&e){let s=new Event("click",{bubbles:t});x.indeterminate=Z(o),e.call(x,!Z(o)&&o),x.dispatchEvent(s)}},[x,g,o,i]);let b=r.useRef(!Z(o)&&o);return(0,a.jsx)(I.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??b.current,required:l,disabled:c,name:u,value:p,form:h,...t,tabIndex:-1,ref:f,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function Z(e){return"indeterminate"===e}function Q(e){return Z(e)?"indeterminate":e?"checked":"unchecked"}function Y({className:e,...t}){return(0,a.jsx)(K,{"data-slot":"checkbox",className:(0,y.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,a.jsx)(X,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,a.jsx)(b.A,{className:"size-3.5"})})})}function ee(){let{pending:e}=(0,d.useFormStatus)();return(0,a.jsx)(u.$,{type:"submit",disabled:e,children:e?"Saving...":"Save"})}function et({index:e,preprocessors:t,preprocessorInputs:s,setPreprocessorInputs:r}){return(0,a.jsx)("div",{className:"my-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"preprocessor-name-"+e,children:"Name"}),(0,a.jsxs)(N,{required:!0,value:s[e].name,onValueChange:t=>r(s.map((s,a)=>a===e?{...s,name:t}:s)),children:[(0,a.jsx)(_,{className:"col-span-3",children:(0,a.jsx)(w,{placeholder:"Select a preprocessor"})}),(0,a.jsx)(k,{className:"col-span-3",children:t.map(e=>(0,a.jsx)(C,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"preprocessor-params-"+e,children:"Params"}),(0,a.jsx)(h.p,{id:"preprocessor-params-"+e,className:"col-span-3",placeholder:'{"max_length": 512}',required:!0,value:s[e].params,onChange:t=>r(s.map((s,a)=>a===e?{...s,params:t.target.value}:s))})]})]})})}function es({datasetId:e,shardsets:t,preprocessors:s,children:d}){let[f,g]=(0,r.useState)(""),[v,b]=(0,r.useState)([]),[j,y]=(0,r.useState)([]),[P,D]=(0,r.useState)([]),[S,z]=(0,r.useState)(1),[E,R]=(0,r.useState)(!1),[U,T]=(0,r.useState)(!1),[G,I]=(0,r.useState)(!1),L=(0,r.useRef)(null),q=()=>{g(""),b([]),y([]),D([]),z(1),L.current?.reset()},F=async t=>{let s="";try{let e=v.map(e=>({name:e.name,params:JSON.parse(e.params)}));s=JSON.stringify(e)}catch(e){o.oR.error("Invalid preprocessor params");return}let a=await A(e,f,j,s,P,S,E,U);a.success?(o.oR.success("Started preprocessing"),I(!1),q()):o.oR.error(`Failed to start preprocessing: ${a.error}`)};return 0===s.length?(0,a.jsxs)(p.lG,{open:G,onOpenChange:I,children:[(0,a.jsx)(p.zM,{asChild:!0,children:d}),(0,a.jsx)(p.Cf,{className:"sm:max-w-[600px]",children:(0,a.jsxs)(p.c7,{children:[(0,a.jsx)(p.L3,{children:"No preprocessors found!"}),(0,a.jsx)(p.rr,{children:"Please create a preprocessor first."})]})})]}):(0,a.jsxs)(p.lG,{open:G,onOpenChange:I,children:[(0,a.jsx)(p.zM,{asChild:!0,children:d}),(0,a.jsxs)(p.Cf,{className:"sm:max-w-[600px]",children:[(0,a.jsxs)(p.c7,{children:[(0,a.jsx)(p.L3,{children:"Preprocess"}),(0,a.jsx)(p.rr,{children:"Generate a new shardset by preprocessing the dataset."})]}),(0,a.jsxs)("form",{ref:L,action:F,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)("div",{className:"text-lg mt-2",children:"Source"}),j.map((e,s)=>(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"source",className:"text-right",children:"Shardset"}),(0,a.jsxs)(N,{name:"source",required:!0,value:e,onValueChange:e=>y(t=>{let a=[...t];return a[s]=e,a}),children:[(0,a.jsx)(_,{className:"col-span-3",children:(0,a.jsx)(w,{placeholder:"Select a source"})}),(0,a.jsx)(k,{className:"col-span-3",children:t.map(e=>(0,a.jsx)(C,{value:e.id,disabled:j.includes(e.id),children:e.location},e.id))})]})]},`sourceShardset-${s}`)),j.length<t.length&&(0,a.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>y([...j,""]),children:[(0,a.jsx)(n.A,{}),"Add Source Shardset"]}),(0,a.jsxs)("div",{className:"text-lg mt-2 flex gap-2 items-center",children:[(0,a.jsx)("div",{children:"Preprocessors"}),(0,a.jsx)(m.F,{icon:(0,a.jsx)(i.A,{className:"w-4 h-4"}),content:(0,a.jsx)("p",{})})]}),(0,a.jsx)(l.F,{className:"max-h-[200px]",children:v.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(et,{index:t,preprocessors:s,preprocessorInputs:v,setPreprocessorInputs:b}),(0,a.jsx)(c.w,{className:"my-2"})]},t))}),(0,a.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>b([...v,{name:"",params:"{}"}]),children:[(0,a.jsx)(n.A,{}),"Add Preprocessor"]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)("div",{className:"text-lg mt-2",children:"Configuration"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"location",className:"text-right",children:"Batch Size"}),(0,a.jsx)(h.p,{id:"batch_size",name:"batch_size",type:"number",className:"col-span-3",placeholder:"100",required:!0,value:S,onChange:e=>z(Number(e.target.value))})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)("div",{className:"text-lg mt-2",children:"Output"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"location",className:"text-right",children:"Location"}),(0,a.jsx)(h.p,{id:"location",name:"location",className:"col-span-3",placeholder:"s3://bucket/path/to/shardset/",required:!0,value:f,onChange:e=>g(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"location",className:"text-right",children:"Overwrite"}),(0,a.jsx)(Y,{id:"overwrite",name:"overwrite",checked:E,onCheckedChange:e=>R("indeterminate"!==e&&e)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(x.J,{htmlFor:"location",className:"text-right",children:"Drop Last"}),(0,a.jsx)(Y,{id:"drop_last",name:"drop_last",checked:U,onCheckedChange:e=>T("indeterminate"!==e&&e)})]}),P.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(x.J,{htmlFor:"location",className:"text-right",children:["Export Column ",t+1]}),(0,a.jsx)(h.p,{id:"location",name:"location",className:"col-span-3",placeholder:"new_column_name",required:!0,value:e,onChange:e=>D(s=>{let a=[...s];return a[t]=e.target.value,a})},`export-column-${t}`)]})),(0,a.jsxs)(u.$,{type:"button",variant:"outline",className:"",onClick:()=>D([...P,""]),children:[(0,a.jsx)(n.A,{}),"Add Export Column"]})]}),(0,a.jsx)(p.Es,{children:(0,a.jsx)(ee,{})})]})]})]})}W.displayName=H},51087:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"40d4c994140d7162fca88e9904afda9aa41cabc15e":()=>i,"7f3e229e64fb29737787879fbf882b5c02753f43c3":()=>o});var a=s(6391);s(80127);var r=s(17773),n=s(63995);async function i(e){try{let t=await (await (0,r.KU)()).DELETE("/datasets/{dataset_id}",{params:{path:{dataset_id:e}}});if(t.error)return{success:!1,error:t.error.detail};return{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An unexpected error occurred"}}}async function o(e,t,s,a,n,i,o,d){let l=[];try{l=JSON.parse(a)}catch(e){return{success:!1,error:"Invalid preprocessors data"}}try{let a=await (await (0,r.KU)()).POST("/datasets/{dataset_id}/preprocess",{params:{path:{dataset_id:e}},body:{shardset_location:t,source_shardset_ids:s,preprocessors:l,export_columns:n,batch_size:i,overwrite:o,drop_last:d}});if(a.error){let e="Unknown error";return"string"==typeof a.error.detail&&(e=a.error.detail),{success:!1,error:e}}return{success:!0,data:a.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An unexpected error occurred"}}}(0,n.D)([i]),(0,a.A)(i,"40d4c994140d7162fca88e9904afda9aa41cabc15e",null),(0,n.D)([o]),(0,a.A)(o,"7f3e229e64fb29737787879fbf882b5c02753f43c3",null)},54845:(e,t,s)=>{Promise.resolve().then(s.bind(s,65854)),Promise.resolve().then(s.bind(s,69476)),Promise.resolve().then(s.bind(s,50149)),Promise.resolve().then(s.bind(s,28077))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63354:(e,t,s)=>{"use strict";s.d(t,{X:()=>n});var a=s(65138),r=s(42850);function n(e){let[t,s]=a.useState(void 0);return(0,r.N)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let a,r;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,r=t.blockSize}else a=e.offsetWidth,r=e.offsetHeight;s({width:a,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}s(void 0)},[e]),t}},69476:(e,t,s)=>{"use strict";s.d(t,{DeleteDatasetDialog:()=>l});var a=s(40871),r=s(24983),n=s(82070),i=s(36931);let o=(0,i.createServerReference)("40d4c994140d7162fca88e9904afda9aa41cabc15e",i.callServer,void 0,i.findSourceMapURL,"deleteDataset");var d=s(90181);function l({datasetId:e,children:t}){let s=(0,d.useRouter)(),i=async()=>{let t=await o(e);t.success?(r.oR.success("Dataset deleted successfully"),s.push("/datasets")):r.oR.error(`Failed to delete dataset: ${t.error}`)};return(0,a.jsxs)(n.Lt,{children:[(0,a.jsx)(n.tv,{asChild:!0,children:t}),(0,a.jsxs)(n.EO,{children:[(0,a.jsxs)(n.wd,{children:[(0,a.jsx)(n.r7,{children:"Are you absolutely sure?"}),(0,a.jsx)(n.$v,{children:"This action cannot be undone. This will permanently delete your dataset, related shardsets and iterations. Of course, actual data will not be affected."})]}),(0,a.jsxs)(n.ck,{children:[(0,a.jsx)(n.Zr,{children:"Cancel"}),(0,a.jsx)(n.Rx,{onClick:i,children:"Continue"})]})]})]})}},72336:(e,t,s)=>{"use strict";s.d(t,{PreprocessDatasetDialog:()=>a});let a=(0,s(26259).registerClientReference)(function(){throw Error("Attempted to call PreprocessDatasetDialog() from the server but PreprocessDatasetDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/settings/preprocess-dataset-dialog.tsx","PreprocessDatasetDialog")},87557:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(94829),r=s(32253),n=s(72188),i=s(44155),o=s(40931),d=s(22393),l=s(72336),c=s(48161);async function u({params:e}){let{dataset_id:t}=await e,s=await (0,n.KU)(),u=await s.GET("/datasets/{dataset_id}",{params:{path:{dataset_id:t}}}),p=await s.GET("/registries/preprocessors",{});if(u.error)return(0,a.jsx)(i.ErrorCard,{error:u.error.detail});if(!p.data)return(0,a.jsx)(i.ErrorCard,{error:p.error});let h=u.data;return(0,a.jsx)("div",{className:"w-full max-w-[720px] flex flex-col gap-2 items-start",children:(0,a.jsx)(o.Zp,{className:"w-full",children:(0,a.jsxs)(o.Wu,{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_200px] gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-md",children:"Sync shardsets"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Sync the all shardsets of this dataset to their locations."})]}),(0,a.jsx)(c.Q,{dataset_id:t,shardsets:h.shardsets.map(e=>e.id)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_200px] gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-md",children:"Preprocess"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Generate a new shardset by preprocessing the dataset."})]}),(0,a.jsx)(l.PreprocessDatasetDialog,{datasetId:t,shardsets:h.shardsets,preprocessors:p.data.map(e=>e.name),children:(0,a.jsx)(r.$,{variant:"default",children:"Preprocess"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_200px] gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-md",children:"Delete this dataset"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"This action is irreversible."})]}),(0,a.jsx)(d.DeleteDatasetDialog,{datasetId:t,children:(0,a.jsx)(r.$,{variant:"destructive",children:"Delete this dataset"})})]})]})})})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[294,94,562,543,751,585,279,807,36,247,463,966,323],()=>s(334));module.exports=a})();