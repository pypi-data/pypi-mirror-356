(()=>{var e={};e.id=137,e.ids=[137],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8041:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(40871),r=s(30618);let n=({icon:e,content:t})=>(0,a.jsxs)(r.Tooltip,{children:[(0,a.jsx)(r.TooltipTrigger,{asChild:!0,children:e}),(0,a.jsx)(r.TooltipContent,{children:t})]})},10839:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>u,Es:()=>x,L3:()=>p,c7:()=>h,lG:()=>o,rr:()=>m,zM:()=>i});var a=s(40871);s(65138);var r=s(32506),n=s(98154),d=s(75908);function o({...e}){return(0,a.jsx)(r.bL,{"data-slot":"dialog",...e})}function i({...e}){return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...e})}function l({...e}){return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...e})}function c({className:e,...t}){return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,d.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e),...t})}function u({className:e,children:t,...s}){return(0,a.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,a.jsx)(c,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,d.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,(0,a.jsxs)(r.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(n.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function h({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,d.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function x({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,d.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function p({className:e,...t}){return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,d.cn)("text-lg leading-none font-semibold",e),...t})}function m({className:e,...t}){return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,d.cn)("text-muted-foreground text-sm",e),...t})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13804:(e,t,s)=>{"use strict";s.d(t,{F:()=>d});var a=s(40871);s(65138);var r=s(8019),n=s(75908);function d({className:e,children:t,...s}){return(0,a.jsxs)(r.bL,{"data-slot":"scroll-area",className:(0,n.cn)("relative",e),...s,children:[(0,a.jsx)(r.LM,{"data-slot":"scroll-area-viewport",className:"ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1",children:t}),(0,a.jsx)(o,{}),(0,a.jsx)(r.OK,{})]})}function o({className:e,orientation:t="vertical",...s}){return(0,a.jsx)(r.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,n.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...s,children:(0,a.jsx)(r.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},17141:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var a=s(40871);s(65138);var r=s(44989),n=s(75908);function d({className:e,...t}){return(0,a.jsx)(r.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}},17773:(e,t,s)=>{"use strict";s.d(t,{KU:()=>i,my:()=>l});var a=s(10146),r=s(87080),n=s(77893);let d=()=>process.env.API_URL||"http://localhost:8000",o=async()=>{let e=await (0,r.UL)();return e.get("lavender-data-api-key")?.value},i=async()=>{let e=d(),t=await o();return(0,a.Ay)({baseUrl:e,headers:t?{Authorization:`Basic ${t}`}:{},fetch:async e=>{let t=await fetch(e,{cache:"no-store"});return(401===t.status||403===t.status)&&(0,n.redirect)("/set-api-key"),t}})},l=async e=>{let t=d();return(0,a.Ay)({baseUrl:t,headers:{Authorization:`Basic ${e}`},fetch:async e=>fetch(e,{cache:"no-store"})})}},18529:(e,t,s)=>{"use strict";s.d(t,{A0:()=>d,BF:()=>o,Hj:()=>i,XI:()=>n,nA:()=>c,nd:()=>l});var a=s(94829);s(72024);var r=s(77678);function n({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",e),...t})})}function d({className:e,...t}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",e),...t})}function o({className:e,...t}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",e),...t})}function i({className:e,...t}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function l({className:e,...t}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function c({className:e,...t}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32253:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(94829);s(72024);var r=s(26219),n=s(88606),d=s(77678);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function i({className:e,variant:t,size:s,asChild:n=!1,...i}){let l=n?r.Slot:"button";return(0,a.jsx)(l,{"data-slot":"button",className:(0,d.cn)(o({variant:t,size:s,className:e})),...i})}},33873:e=>{"use strict";e.exports=require("path")},39189:(e,t,s)=>{Promise.resolve().then(s.bind(s,26219)),Promise.resolve().then(s.t.bind(s,36128,23)),Promise.resolve().then(s.bind(s,40583)),Promise.resolve().then(s.bind(s,44155))},40583:(e,t,s)=>{"use strict";s.d(t,{AddShardsetDialog:()=>a});let a=(0,s(26259).registerClientReference)(function(){throw Error("Attempted to call AddShardsetDialog() from the server but AddShardsetDialog is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/shardsets/add-shardset-dialog.tsx","AddShardsetDialog")},40931:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>d,Zp:()=>n});var a=s(94829);s(72024);var r=s(77678);function n({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function d({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...t})}},46870:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>d.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>l});var a=s(20863),r=s(38832),n=s(39682),d=s.n(n),o=s(11461),i={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let l={children:["",{children:["datasets",{children:["[dataset_id]",{children:["shardsets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,85183)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/shardsets/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,37374)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,28950)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,94677)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,74595)),"/Users/hanch/fal/lavender-data/ui/src/app/datasets/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,14127)),"/Users/hanch/fal/lavender-data/ui/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,58206,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,63447,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,94716,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/hanch/fal/lavender-data/ui/src/app/datasets/[dataset_id]/shardsets/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/datasets/[dataset_id]/shardsets/page",pathname:"/datasets/[dataset_id]/shardsets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},52757:(e,t,s)=>{Promise.resolve().then(s.bind(s,65854)),Promise.resolve().then(s.t.bind(s,54574,23)),Promise.resolve().then(s.bind(s,96416)),Promise.resolve().then(s.bind(s,28077))},60806:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"60e49b3883dafa994d21274b682480d5af48153456":()=>d});var a=s(6391);s(80127);var r=s(17773),n=s(68288);async function d(e,t){let s=t.get("location"),a=t.get("columnsJson"),d=[];try{d=JSON.parse(a)}catch(e){return{success:!1,error:"Invalid column data"}}if(!s)return{success:!1,error:"Location is required"};if(d.some(e=>""===e.name))return{success:!1,error:"All columns must have a name"};if(d.some(e=>""===e.type))return{success:!1,error:"All columns must have a type"};try{let t=await (await (0,r.KU)()).POST("/datasets/{dataset_id}/shardsets",{params:{path:{dataset_id:e}},body:{location:s,columns:d}});if(t.error){let e="Unknown error";return"string"==typeof t.error.detail&&(e=t.error.detail),{success:!1,error:e}}return(0,n.revalidatePath)(`/datasets/${e}`),{success:!0,data:t.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An unexpected error occurred"}}}(0,s(63995).D)([d]),(0,a.A)(d,"60e49b3883dafa994d21274b682480d5af48153456",null)},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77678:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var a=s(11942),r=s(59822);function n(...e){return(0,r.QP)((0,a.$)(e))}},85183:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(94829),r=s(36128),n=s.n(r),d=s(65458),o=s(32253),i=s(18529),l=s(72188),c=s(40583),u=s(44155),h=s(40931);function x({shardset:e}){return e?(0,a.jsxs)(n(),{href:`/datasets/${e.dataset_id}/shardsets/${e.id}`,children:[(0,a.jsx)("div",{className:"font-mono text-xs",children:e.id}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.location}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["total ",e.total_samples," samples, ",e.shard_count," shards"]})]}):(0,a.jsx)("div",{children:"-"})}async function p({params:e}){let{dataset_id:t}=await e,s=await (0,l.KU)(),r=await s.GET("/datasets/{dataset_id}",{params:{path:{dataset_id:t}}});if(r.error)return(0,a.jsx)(u.ErrorCard,{error:r.error.detail});let n=r.data,p=n.columns.filter(e=>e.name!==n.uid_column_name).map((e,t)=>({...e,rowSpan:1})).sort((e,t)=>e.shardset_id.localeCompare(t.shardset_id)||e.name.localeCompare(t.name)),m=0;return p.forEach((e,t)=>{e.shardset_id!==p[m].shardset_id?m=t:(p[t].rowSpan=0,p[m].rowSpan++)}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(h.Zp,{className:"w-full",children:(0,a.jsx)(h.Wu,{children:(0,a.jsxs)(i.XI,{children:[(0,a.jsx)(i.A0,{children:(0,a.jsxs)(i.Hj,{children:[(0,a.jsx)(i.nd,{children:"Shardset"}),(0,a.jsx)(i.nd,{className:"w-[100px]",children:"Name"}),(0,a.jsx)(i.nd,{children:"Type"}),(0,a.jsx)(i.nd,{children:"Description"})]})}),(0,a.jsxs)(i.BF,{children:[(0,a.jsxs)(i.Hj,{children:[(0,a.jsx)(i.nA,{children:"-"}),(0,a.jsx)(i.nA,{className:"font-mono text-xs",children:n.uid_column_name}),(0,a.jsx)(i.nA,{children:"-"}),(0,a.jsx)(i.nA,{children:"Unique identifier for each sample"})]}),p.map(e=>(0,a.jsxs)(i.Hj,{children:[e.rowSpan>0&&(0,a.jsx)(i.nA,{rowSpan:e.rowSpan,children:(0,a.jsx)(x,{shardset:n.shardsets.find(t=>t.id===e.shardset_id)})}),(0,a.jsx)(i.nA,{className:"font-mono text-xs",children:e.name}),(0,a.jsx)(i.nA,{children:e.type}),(0,a.jsx)(i.nA,{children:e.description})]},e.id))]})]})})}),(0,a.jsx)("div",{className:"w-full flex justify-end",children:(0,a.jsx)(c.AddShardsetDialog,{datasetId:t,children:(0,a.jsxs)(o.$,{variant:"outline",children:[(0,a.jsx)(d.A,{}),"Shardset"]})})})]})}},88526:(e,t,s)=>{"use strict";function a(e,[t,s]){return Math.min(s,Math.max(t,e))}s.d(t,{q:()=>a})},96416:(e,t,s)=>{"use strict";s.d(t,{AddShardsetDialog:()=>b});var a=s(40871),r=s(65138),n=s(15376),d=s(22384),o=s(24983),i=s(21895),l=s(13804),c=s(33094),u=s(26123),h=s(10839),x=s(68491),p=s(17141),m=s(8041),f=s(36931);let v=(0,f.createServerReference)("60e49b3883dafa994d21274b682480d5af48153456",f.callServer,void 0,f.findSourceMapURL,"createShardset");function g(){let{pending:e}=(0,i.useFormStatus)();return(0,a.jsx)(u.$,{type:"submit",disabled:e,children:e?"Saving...":"Save"})}function j({index:e,columns:t,setColumns:s}){return(0,a.jsx)("div",{className:"my-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(p.J,{htmlFor:"column-name-"+e,children:"Name"}),(0,a.jsx)(x.p,{id:"column-name-"+e,className:"col-span-3",placeholder:"caption",required:!0,value:t[e].name,onChange:a=>s(t.map((t,s)=>s===e?{...t,name:a.target.value}:t))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(p.J,{htmlFor:"column-type-"+e,children:"Type"}),(0,a.jsx)(x.p,{id:"column-type-"+e,className:"col-span-3",placeholder:"text",required:!0,value:t[e].type,onChange:a=>s(t.map((t,s)=>s===e?{...t,type:a.target.value}:t))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsxs)(p.J,{className:"flex flex-col items-start gap-0",htmlFor:"column-description-"+e,children:[(0,a.jsx)("div",{children:"Description"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"(Optional)"})]}),(0,a.jsx)(x.p,{id:"column-description-"+e,className:"col-span-3",placeholder:"A caption for the image",value:t[e].description??"",onChange:a=>s(t.map((t,s)=>s===e?{...t,description:a.target.value}:t))})]})]})})}function b({datasetId:e,children:t}){let[s,i]=(0,r.useState)(""),[f,b]=(0,r.useState)([]),[y,w]=(0,r.useState)(!1),N=(0,r.useRef)(null),_=async t=>{t.set("columnsJson",JSON.stringify(f));let s=await v(e,t);s.success?(o.oR.success("Shardset added successfully"),w(!1),i(""),b([]),N.current?.reset()):o.oR.error(`Failed to add shardset: ${s.error}`)};return(0,a.jsxs)(h.lG,{open:y,onOpenChange:w,children:[(0,a.jsx)(h.zM,{asChild:!0,children:t}),(0,a.jsxs)(h.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:"New shardset"}),(0,a.jsx)(h.rr,{children:"Add a new shardset with columns to the dataset."})]}),(0,a.jsxs)("form",{ref:N,action:_,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)("div",{className:"text-lg mt-2",children:"Shardset"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(p.J,{htmlFor:"location",className:"text-right",children:"Location"}),(0,a.jsx)(x.p,{id:"location",name:"location",className:"col-span-3",placeholder:"s3://bucket/path/to/shardset/",required:!0,value:s,onChange:e=>i(e.target.value)})]}),(0,a.jsxs)("div",{className:"text-lg mt-2 flex gap-2 items-center",children:[(0,a.jsx)("div",{children:"Columns"}),(0,a.jsx)(m.F,{icon:(0,a.jsx)(n.A,{className:"w-4 h-4"}),content:(0,a.jsxs)("p",{children:["If you have at least one shard in the location, the columns will be inferred from the shard. ",(0,a.jsx)("br",{}),"Please specify columns if you want to override them or if you don't have any shards yet."]})})]}),(0,a.jsx)(l.F,{className:"max-h-[200px]",children:f.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(j,{index:t,columns:f,setColumns:b}),(0,a.jsx)(c.w,{className:"my-2"})]},t))}),(0,a.jsxs)(u.$,{type:"button",variant:"outline",onClick:()=>b([...f,{name:"",type:""}]),children:[(0,a.jsx)(d.A,{}),"Add Column"]})]}),(0,a.jsx)(h.Es,{children:(0,a.jsx)(g,{})})]})]})]})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[294,94,562,543,751,585,856,247,463,966],()=>s(46870));module.exports=a})();